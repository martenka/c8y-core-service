{"openapi":"3.0.0","paths":{"/v1":{"get":{"operationId":"Hello World route","summary":"","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"string"}}}}}}},"/v1/sensors":{"post":{"operationId":"Create a new sensor","summary":"","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CreateSensorDto"}}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutputSensorDto"}}}}},"tags":["sensors"]},"patch":{"operationId":"Update sensors","summary":"","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UpdateSensorDto"}}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OutputSensorDto"}}}}}},"tags":["sensors"]}},"/v1/sensors/search":{"get":{"operationId":"Search sensors","summary":"","parameters":[{"name":"id","required":false,"in":"query","schema":{"type":"string"}},{"name":"query","required":false,"in":"query","schema":{"type":"string"}},{"name":"searchType","required":false,"in":"query","schema":{"enum":["token","prefix"],"type":"string"}},{"name":"managedObjectId","required":false,"in":"query","schema":{"type":"string"}},{"name":"managedObjectName","required":false,"in":"query","schema":{"type":"string"}},{"name":"valueFragmentType","required":false,"in":"query","schema":{"type":"string"}},{"name":"valueFragmentDisplayName","required":false,"in":"query","schema":{"type":"string"}},{"name":"pageSize","required":false,"in":"query","schema":{"minimum":1,"type":"number"}},{"name":"currentPage","required":false,"in":"query","schema":{"minimum":1,"type":"number"}},{"name":"withTotalElements","required":false,"in":"query","schema":{"type":"boolean"}},{"name":"withTotalPages","required":false,"in":"query","schema":{"type":"boolean"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedOutputSensorDto"}}}}},"tags":["sensors"]}},"/v1/sensors/{id}":{"get":{"operationId":"Get one sensor","summary":"","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutputSensorDto"}}}}},"tags":["sensors"]},"patch":{"operationId":"Update one sensor","summary":"","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateOneSensorDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutputSensorDto"}}}}},"tags":["sensors"]},"delete":{"operationId":"Delete sensor","summary":"","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutputSensorDto"}}}}},"tags":["sensors"]}},"/v1/groups":{"post":{"operationId":"Create a new group","summary":"","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CreateGroupDto"}}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OutputGroupDto"}}}}}},"tags":["groups"]},"patch":{"operationId":"Update groups","summary":"","description":"Merges new sensors with existing ones","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UpdateGroupDto"}}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OutputGroupDto"}}}}}},"tags":["groups"]}},"/v1/groups/search":{"get":{"operationId":"Search groups","summary":"","parameters":[{"name":"id","required":false,"in":"query","schema":{"type":"string"}},{"name":"name","required":false,"in":"query","schema":{"type":"string"}},{"name":"searchType","required":false,"in":"query","schema":{"enum":["token","prefix"],"type":"string"}},{"name":"pageSize","required":false,"in":"query","schema":{"minimum":1,"type":"number"}},{"name":"currentPage","required":false,"in":"query","schema":{"minimum":1,"type":"number"}},{"name":"withTotalElements","required":false,"in":"query","schema":{"type":"boolean"}},{"name":"withTotalPages","required":false,"in":"query","schema":{"type":"boolean"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedOutputGroupDto"}}}}},"tags":["groups"]}},"/v1/groups/{id}":{"get":{"operationId":"Get one group","summary":"","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutputGroupDto"}}}}},"tags":["groups"]},"delete":{"operationId":"Delete group","summary":"","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutputGroupDto"}}}}},"tags":["groups"]}},"/v1/auth/login":{"post":{"operationId":"Login","summary":"","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}}},"responses":{"201":{"description":"Access token was created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponseDto"}}}}},"tags":["auth"]}},"/v1/auth/register":{"post":{"operationId":"Register a new user","summary":"","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserDto"}}}},"responses":{"201":{"description":"User registered","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOutputDto"}}}}},"tags":["auth"]}},"/v1/users/{id}":{"get":{"operationId":"Get one user","summary":"","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOutputDto"}}}}},"tags":["users"]},"patch":{"operationId":"Update user","summary":"","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOutputDto"}}}}},"tags":["users"]}},"/v1/users/delete":{"post":{"operationId":"Remove users","summary":"","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteUserInputDto"}}}},"responses":{"200":{"description":""}},"tags":["users"]}},"/v1/files/upload-readiness":{"get":{"operationId":"Check for files upload readiness to external system","summary":"","parameters":[{"name":"fileIds","required":true,"in":"query","description":"File ids to check","schema":{"type":"array","items":{"type":"string"}}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"type":"object"}}}}}},"tags":["files"]}},"/v1/files/search":{"get":{"operationId":"Search files","summary":"","parameters":[{"name":"id","required":false,"in":"query","schema":{"type":"string"}},{"name":"createdByTask","required":false,"in":"query","schema":{"type":"string"}},{"name":"dateFrom","required":false,"in":"query","description":"ISO8601 string","schema":{"format":"date-time","type":"string"}},{"name":"dateTo","required":false,"in":"query","description":"ISO8601 string","schema":{"format":"date-time","type":"string"}},{"name":"name","required":false,"in":"query","schema":{"type":"string"}},{"name":"managedObjectId","required":false,"in":"query","schema":{"type":"string"}},{"name":"managedObjectName","required":false,"in":"query","schema":{"type":"string"}},{"name":"valueFragmentType","required":false,"in":"query","schema":{"type":"string"}},{"name":"valueFragmentDisplayName","required":false,"in":"query","schema":{"type":"string"}},{"name":"pageSize","required":false,"in":"query","schema":{"minimum":1,"type":"number"}},{"name":"currentPage","required":false,"in":"query","schema":{"minimum":1,"type":"number"}},{"name":"withTotalElements","required":false,"in":"query","schema":{"type":"boolean"}},{"name":"withTotalPages","required":false,"in":"query","schema":{"type":"boolean"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedOutputFileDto"}}}}},"tags":["files"]}},"/v1/files/{id}":{"get":{"operationId":"Get one file","summary":"","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutputFileDto"}}}}},"tags":["files"]},"delete":{"operationId":"Delete file","summary":"","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["files"]}},"/v1/files/{id}/link":{"get":{"operationId":"Get file download link","summary":"","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"required":["id","url"],"properties":{"id":{"type":"string","description":"File ID"},"url":{"type":"string"},"fileName":{"type":"string"}}}}}}},"tags":["files"]}},"/v1/files/{id}/visibility-state":{"post":{"operationId":"Change file visibility state","summary":"","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VisibilityStateDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutputFileDto"}}}},"201":{"description":"","content":{"application/json":{"schema":{"type":"object"}}}}},"tags":["files"]}},"/v1/files/delete":{"post":{"operationId":"Remove files","summary":"","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteInputDto"}}}},"responses":{"200":{"description":""}},"tags":["files"]}},"/v1/tasks":{"post":{"operationId":"Create a new task","summary":"","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/CreateDataFetchDto"},{"$ref":"#/components/schemas/CreateDataUploadTaskDto"},{"$ref":"#/components/schemas/CreateObjectSyncDto"}]}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutputTaskDto"}}}},"201":{"description":"","content":{"application/json":{"schema":{"type":"object"}}}}},"tags":["tasks"]}},"/v1/tasks/search":{"get":{"operationId":"Search tasks","summary":"","parameters":[{"name":"id","required":false,"in":"query","schema":{"type":"string"}},{"name":"taskType","required":false,"in":"query","schema":{"enum":["DATA_FETCH","DATA_UPLOAD","OBJECT_SYNC"],"type":"string"}},{"name":"taskStatus","required":false,"in":"query","schema":{"enum":["NOT_STARTED","IN_QUEUE","PROCESSING","DONE","FAILED"],"type":"string"}},{"name":"name","required":false,"in":"query","schema":{"type":"string"}},{"name":"firstRunAt","required":false,"in":"query","schema":{"type":"string"}},{"name":"isPeriodic","required":false,"in":"query","schema":{"type":"boolean"}},{"name":"pageSize","required":false,"in":"query","schema":{"minimum":1,"type":"number"}},{"name":"currentPage","required":false,"in":"query","schema":{"minimum":1,"type":"number"}},{"name":"withTotalElements","required":false,"in":"query","schema":{"type":"boolean"}},{"name":"withTotalPages","required":false,"in":"query","schema":{"type":"boolean"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedOutputTaskDto"}}}}},"tags":["tasks"]}},"/v1/tasks/{id}":{"get":{"operationId":"Get one task","summary":"","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutputTaskDto"}}}}},"tags":["tasks"]}}},"info":{"title":"C8y-Core-Service","description":"This API describes the operations of c8y-core-service. \n      To use the methods in this API, user account is required. You can use the default account or create a new user.  \n      There are two types of users: administrator and normal users. Only administrator can make state changing operations \n      JWT token is used for authentication, see auth module for details\n    ","version":"1.0","contact":{}},"tags":[{"name":"sensors","description":"This module describes the operations related to sensors"}],"servers":[],"components":{"schemas":{"CreateSensorDto":{"type":"object","properties":{"managedObjectId":{"type":"string"},"managedObjectName":{"type":"string"},"valueFragmentType":{"type":"string"},"valueFragmentDisplayName":{"type":"string"},"owner":{"type":"string"},"type":{"type":"string"},"description":{"type":"string"},"customAttributes":{"type":"object"}},"required":["managedObjectId","managedObjectName","valueFragmentType"]},"OutputSensorDto":{"type":"object","properties":{"id":{"type":"string"},"managedObjectId":{"type":"number"},"managedObjectName":{"type":"string"},"valueFragmentType":{"type":"string"},"valueFragmentDisplayName":{"type":"string"},"type":{"type":"string"},"owner":{"type":"string"},"description":{"type":"string"},"customAttributes":{"type":"object"}},"required":["id","managedObjectId","managedObjectName","valueFragmentType","valueFragmentDisplayName"]},"PageInfo":{"type":"object","properties":{"pageSize":{"type":"number"},"currentPage":{"type":"number"},"totalElements":{"type":"number"},"totalPages":{"type":"number"}},"required":["pageSize"]},"PaginatedOutputSensorDto":{"type":"object","properties":{"pageInfo":{"$ref":"#/components/schemas/PageInfo"},"data":{"type":"array","items":{"$ref":"#/components/schemas/OutputSensorDto"}}},"required":["pageInfo","data"]},"UpdateOneSensorDto":{"type":"object","properties":{"managedObjectId":{"type":"string"},"managedObjectName":{"type":"string"},"valueFragmentType":{"type":"string"},"valueFragmentDisplayName":{"type":"string"},"description":{"type":"string"},"customAttributes":{"type":"object"}}},"UpdateSensorDto":{"type":"object","properties":{"id":{"type":"string"},"managedObjectId":{"type":"string"},"managedObjectName":{"type":"string"},"valueFragmentType":{"type":"string"},"valueFragmentDisplayName":{"type":"string"},"description":{"type":"string"},"customAttributes":{"type":"object"}},"required":["id"]},"CreateGroupDto":{"type":"object","properties":{"name":{"type":"string"},"managedObjectId":{"type":"string"},"description":{"type":"string"},"owner":{"type":"string"},"sensors":{"type":"object"},"groups":{"type":"object"},"customAttributes":{"type":"object"}},"required":["name","sensors","groups"]},"OutputGroupDto":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"sensorAmount":{"type":"number"},"sensors":{"type":"array","items":{"$ref":"#/components/schemas/OutputSensorDto"}},"description":{"type":"string"},"customAttributes":{"type":"object"}},"required":["id","name","sensors"]},"PaginatedOutputGroupDto":{"type":"object","properties":{"pageInfo":{"$ref":"#/components/schemas/PageInfo"},"data":{"type":"array","items":{"$ref":"#/components/schemas/OutputGroupDto"}}},"required":["pageInfo","data"]},"UpdateGroupDto":{"type":"object","properties":{"sensors":{"type":"array","items":{"type":"string"}},"id":{"type":"string"},"name":{"type":"string"},"groups":{"type":"object"},"customAttributes":{"type":"object"}},"required":["sensors","id","groups"]},"LoginDto":{"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"}},"required":["username","password"]},"LoginResponseDto":{"type":"object","properties":{"access_token":{"type":"string"}},"required":["access_token"]},"C8yCredentialsInputDto":{"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"},"tenantID":{"type":"string"},"baseAddress":{"type":"string"}},"required":["username","password","tenantID","baseAddress"]},"CreateUserDto":{"type":"object","properties":{"c8yCredentials":{"$ref":"#/components/schemas/C8yCredentialsInputDto"},"username":{"type":"string"},"password":{"type":"string"},"role":{"type":"array","items":{"type":"string","enum":["User","Admin"]}}},"required":["username","password"]},"C8yCredentialsOutputDto":{"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"},"tenantID":{"type":"string"},"baseAddress":{"type":"string"}},"required":["username","password","tenantID","baseAddress"]},"UserOutputDto":{"type":"object","properties":{"id":{"type":"string"},"username":{"type":"string"},"roles":{"type":"array","items":{"type":"string"}},"c8yCredentials":{"$ref":"#/components/schemas/C8yCredentialsOutputDto"}},"required":["id","roles","c8yCredentials"]},"DeleteUserInputDto":{"type":"object","properties":{"items":{"description":"Array of sensor ids to remove","type":"array","items":{"type":"string"}}},"required":["items"]},"PartialC8yCredentialsInputDto":{"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"},"tenantID":{"type":"string"},"baseAddress":{"type":"string"}}},"UpdateUserDto":{"type":"object","properties":{"role":{"type":"array","items":{"type":"string","enum":["User","Admin"]}},"c8yCredentials":{"$ref":"#/components/schemas/PartialC8yCredentialsInputDto"}}},"OutputFileValueFragmentDto":{"type":"object","properties":{"type":{"type":"string"},"description":{"type":"string"}},"required":["type"]},"OutputFileMetadataDto":{"type":"object","properties":{"sensors":{"type":"array","items":{"type":"string"}},"dateFrom":{"type":"string"},"dateTo":{"type":"string"},"managedObjectId":{"type":"string"},"managedObjectName":{"type":"string"},"valueFragments":{"type":"array","items":{"$ref":"#/components/schemas/OutputFileValueFragmentDto"}}}},"OutputFileStorageDto":{"type":"object","properties":{"bucket":{"type":"string"},"path":{"type":"string"},"url":{"type":"string"}},"required":["bucket","path"]},"OutputFileVisibilityState":{"type":"object","properties":{"published":{"type":"boolean"},"stateChanging":{"type":"boolean"},"errorMessage":{"type":"string"},"exposedToPlatforms":{"type":"string","enum":["CKAN"]}},"required":["published","stateChanging","exposedToPlatforms"]},"OutputFileDto":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"url":{"type":"string"},"createdByTask":{"type":"string"},"description":{"type":"string"},"metadata":{"$ref":"#/components/schemas/OutputFileMetadataDto"},"storage":{"$ref":"#/components/schemas/OutputFileStorageDto"},"visibilityState":{"$ref":"#/components/schemas/OutputFileVisibilityState"},"customAttributes":{"type":"object"},"createdAt":{"type":"string"}},"required":["id","name","visibilityState"]},"PaginatedOutputFileDto":{"type":"object","properties":{"pageInfo":{"$ref":"#/components/schemas/PageInfo"},"data":{"type":"array","items":{"$ref":"#/components/schemas/OutputFileDto"}}},"required":["pageInfo","data"]},"VisibilityStateDto":{"type":"object","properties":{"newVisibilityState":{"type":"string","enum":["PUBLIC","PRIVATE"]}},"required":["newVisibilityState"]},"DeleteInputDto":{"type":"object","properties":{"items":{"description":"File ids to delete","type":"array","items":{"type":"string"}}},"required":["items"]},"OutputTaskPeriodicData":{"type":"object","properties":{"pattern":{"type":"string"},"fetchDurationSeconds":{"type":"number"}},"required":["pattern"]},"OutputTaskMetadata":{"type":"object","properties":{"lastRanAt":{"type":"string"},"lastScheduledAt":{"type":"string"},"lastCompletedAt":{"type":"string"},"lastFailedAt":{"type":"string"},"lastFailReason":{"type":"string"},"firstRunAt":{"type":"string"},"periodicData":{"$ref":"#/components/schemas/OutputTaskPeriodicData"}}},"OutputTaskDto":{"type":"object","properties":{"id":{"type":"string"},"taskType":{"enum":["DATA_FETCH","DATA_UPLOAD","OBJECT_SYNC"],"type":"string"},"name":{"type":"string"},"status":{"enum":["NOT_STARTED","IN_QUEUE","PROCESSING","DONE","FAILED"],"type":"string"},"payload":{"type":"object"},"metadata":{"$ref":"#/components/schemas/OutputTaskMetadata"},"createdAt":{"type":"string"}},"required":["id","taskType","name","status","metadata"]},"PaginatedOutputTaskDto":{"type":"object","properties":{"pageInfo":{"$ref":"#/components/schemas/PageInfo"},"data":{"type":"array","items":{"$ref":"#/components/schemas/OutputTaskDto"}}},"required":["pageInfo","data"]},"DataFetchEntityDto":{"type":"object","properties":{"id":{"type":"string"},"fileName":{"type":"string"}},"required":["id"]},"DataFetchPayloadDto":{"type":"object","properties":{"dateFrom":{"type":"string","format":"date-time"},"dateTo":{"type":"string","format":"date-time"},"entityType":{"type":"string","enum":["GROUP","SENSOR"]},"entities":{"type":"array","items":{"$ref":"#/components/schemas/DataFetchEntityDto"}}},"required":["entityType","entities"]},"PeriodicData":{"type":"object","properties":{"pattern":{"type":"string","description":"Cron pattern (parseable by cron-parser library) or human-interval"},"fetchDurationSeconds":{"type":"object","default":0}},"required":["pattern","fetchDurationSeconds"]},"CreateDataFetchDto":{"type":"object","properties":{"taskPayload":{"$ref":"#/components/schemas/DataFetchPayloadDto"},"taskType":{"type":"string","enum":["DATA_FETCH","DATA_UPLOAD","OBJECT_SYNC"]},"name":{"type":"string"},"periodicData":{"$ref":"#/components/schemas/PeriodicData"},"firstRunAt":{"type":"object","default":"2023-05-11T14:44:11.503Z"}},"required":["taskPayload","taskType","firstRunAt"]},"CreateDataUploadTaskDtoPayload":{"type":"object","properties":{"fileIds":{"type":"array","items":{"type":"string"}}},"required":["fileIds"]},"CreateDataUploadTaskDto":{"type":"object","properties":{"taskPayload":{"$ref":"#/components/schemas/CreateDataUploadTaskDtoPayload"},"taskType":{"type":"string","enum":["DATA_FETCH","DATA_UPLOAD","OBJECT_SYNC"]},"name":{"type":"string"},"periodicData":{"$ref":"#/components/schemas/PeriodicData"},"firstRunAt":{"type":"object","default":"2023-05-11T14:44:11.504Z"}},"required":["taskPayload","taskType","firstRunAt"]},"CreateObjectSyncDto":{"type":"object","properties":{"taskType":{"type":"string","enum":["DATA_FETCH","DATA_UPLOAD","OBJECT_SYNC"]},"name":{"type":"string"},"periodicData":{"$ref":"#/components/schemas/PeriodicData"},"firstRunAt":{"type":"object","default":"2023-05-11T14:44:11.504Z"}},"required":["taskType","firstRunAt"]}}}}